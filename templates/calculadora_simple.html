<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Rutas - Metro Madrid</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #0066cc;
            text-align: center;
            margin-bottom: 30px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            background-color: white;
        }
        select:focus {
            border-color: #0066cc;
            outline: none;
        }
        button {
            width: 100%;
            padding: 15px;
            background-color: #0066cc;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 20px;
        }
        button:hover {
            background-color: #0052a3;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .resultado {
            margin-top: 30px;
            padding: 20px;
            background-color: #f0f8ff;
            border-radius: 5px;
            border-left: 4px solid #0066cc;
        }
        .error {
            background-color: #ffe6e6;
            border-left-color: #cc0000;
            color: #cc0000;
        }
        .estacion {
            padding: 10px;
            margin: 5px 0;
            background-color: white;
            border-radius: 3px;
            border-left: 3px solid #0066cc;
        }
        .linea-badge {
            display: inline-block;
            padding: 2px 8px;
            margin: 2px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
        }
        .loading {
            text-align: center;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöá Calculadora de Rutas Metro Madrid</h1>
        
        <div class="form-group">
            <label for="origen">Estaci√≥n de Origen:</label>
            <select id="origen">
                <option value="">Selecciona una estaci√≥n...</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="destino">Estaci√≥n de Destino:</label>
            <select id="destino">
                <option value="">Selecciona una estaci√≥n...</option>
            </select>
        </div>
        
        <button id="calcular" onclick="calcularRuta()">Calcular Ruta</button>
        
        <div id="resultado"></div>
    </div>

    <script>
        // Datos simulados de estaciones (basado en los datos reales del metro)
        const estaciones = [
            { id: 1, nombre: "Sol", lineas: ["1", "2", "3"] },
            { id: 2, nombre: "Callao", lineas: ["3", "5"] },
            { id: 3, nombre: "Gran V√≠a", lineas: ["1", "5"] },
            { id: 4, nombre: "Atocha Renfe", lineas: ["1"] },
            { id: 5, nombre: "√ìpera", lineas: ["2", "5", "R"] },
            { id: 6, nombre: "Plaza de Espa√±a", lineas: ["3", "10"] },
            { id: 7, nombre: "Tribunal", lineas: ["1", "10"] },
            { id: 8, nombre: "Banco de Espa√±a", lineas: ["2"] },
            { id: 9, nombre: "Retiro", lineas: ["2", "9"] },
            { id: 10, nombre: "Pr√≠ncipe P√≠o", lineas: ["6", "10", "R"] },
            { id: 11, nombre: "Moncloa", lineas: ["3", "6"] },
            { id: 12, nombre: "Cuatro Caminos", lineas: ["1", "2", "6"] },
            { id: 13, nombre: "Alonso Mart√≠nez", lineas: ["4", "5", "10"] },
            { id: 14, nombre: "Bilbao", lineas: ["1", "4"] },
            { id: 15, nombre: "Quevedo", lineas: ["2"] },
            { id: 16, nombre: "Noviciado", lineas: ["2"] },
            { id: 17, nombre: "Santo Domingo", lineas: ["2"] },
            { id: 18, nombre: "Tirso de Molina", lineas: ["1"] },
            { id: 19, nombre: "Ant√≥n Mart√≠n", lineas: ["1"] },
            { id: 20, nombre: "Lavapi√©s", lineas: ["3"] },
            { id: 21, nombre: "Embajadores", lineas: ["3"] },
            { id: 22, nombre: "Palos de la Frontera", lineas: ["3"] },
            { id: 23, nombre: "Delicias", lineas: ["3"] },
            { id: 24, nombre: "Legazpi", lineas: ["3", "6"] },
            { id: 25, nombre: "Arganzuela-Planetario", lineas: ["6"] },
            { id: 26, nombre: "M√©ndez √Ålvaro", lineas: ["6"] },
            { id: 27, nombre: "Pac√≠fico", lineas: ["1", "6"] },
            { id: 28, nombre: "Puente de Vallecas", lineas: ["1"] },
            { id: 29, nombre: "Nueva Numancia", lineas: ["1"] },
            { id: 30, nombre: "Portazgo", lineas: ["1"] }
        ];

        // Colores de las l√≠neas
        const coloresLineas = {
            "1": { bg: "#0080c7", text: "white" },
            "2": { bg: "#ff0000", text: "white" },
            "3": { bg: "#ffff00", text: "black" },
            "4": { bg: "#8b4513", text: "white" },
            "5": { bg: "#90ee90", text: "black" },
            "6": { bg: "#808080", text: "white" },
            "7": { bg: "#ffa500", text: "black" },
            "8": { bg: "#ffc0cb", text: "black" },
            "9": { bg: "#800080", text: "white" },
            "10": { bg: "#000080", text: "white" },
            "11": { bg: "#228b22", text: "white" },
            "12": { bg: "#ffd700", text: "black" },
            "R": { bg: "#654321", text: "white" }
        };

        // Cargar estaciones en los selectores
        function cargarEstaciones() {
            const origenSelect = document.getElementById('origen');
            const destinoSelect = document.getElementById('destino');
            
            estaciones.forEach(estacion => {
                const option1 = document.createElement('option');
                option1.value = estacion.id;
                option1.textContent = estacion.nombre;
                origenSelect.appendChild(option1);
                
                const option2 = document.createElement('option');
                option2.value = estacion.id;
                option2.textContent = estacion.nombre;
                destinoSelect.appendChild(option2);
            });
        }

        // Algoritmo simple de b√∫squeda de ruta (BFS)
        function encontrarRuta(origenId, destinoId) {
            if (origenId === destinoId) {
                return {
                    ruta: [origenId],
                    transbordos: 0,
                    tiempo: 0
                };
            }

            const origen = estaciones.find(e => e.id == origenId);
            const destino = estaciones.find(e => e.id == destinoId);
            
            // Buscar l√≠neas comunes
            const lineasComunes = origen.lineas.filter(linea => 
                destino.lineas.includes(linea)
            );
            
            if (lineasComunes.length > 0) {
                // Ruta directa sin transbordos
                return {
                    ruta: [origenId, destinoId],
                    transbordos: 0,
                    tiempo: 5, // 5 minutos estimado
                    linea: lineasComunes[0]
                };
            }
            
            // Buscar ruta con 1 transbordo
            for (let estacionIntermedia of estaciones) {
                const lineasOrigenIntermedia = origen.lineas.filter(linea => 
                    estacionIntermedia.lineas.includes(linea)
                );
                const lineasIntermediadDestino = estacionIntermedia.lineas.filter(linea => 
                    destino.lineas.includes(linea)
                );
                
                if (lineasOrigenIntermedia.length > 0 && lineasIntermediadDestino.length > 0) {
                    return {
                        ruta: [origenId, estacionIntermedia.id, destinoId],
                        transbordos: 1,
                        tiempo: 12, // 12 minutos estimado
                        lineas: [lineasOrigenIntermedia[0], lineasIntermediadDestino[0]]
                    };
                }
            }
            
            return null; // No se encontr√≥ ruta
        }

        function calcularRuta() {
            const origenId = document.getElementById('origen').value;
            const destinoId = document.getElementById('destino').value;
            const resultadoDiv = document.getElementById('resultado');
            
            if (!origenId || !destinoId) {
                resultadoDiv.innerHTML = '<div class="resultado error">Por favor selecciona origen y destino</div>';
                return;
            }
            
            if (origenId === destinoId) {
                resultadoDiv.innerHTML = '<div class="resultado error">El origen y destino no pueden ser iguales</div>';
                return;
            }
            
            resultadoDiv.innerHTML = '<div class="loading">Calculando ruta...</div>';
            
            setTimeout(() => {
                const ruta = encontrarRuta(origenId, destinoId);
                
                if (!ruta) {
                    resultadoDiv.innerHTML = '<div class="resultado error">No se encontr√≥ una ruta entre estas estaciones</div>';
                    return;
                }
                
                let html = '<div class="resultado">';
                html += '<h3>üìç Ruta Encontrada</h3>';
                html += `<p><strong>‚è±Ô∏è Tiempo estimado:</strong> ${ruta.tiempo} minutos</p>`;
                html += `<p><strong>üîÑ Transbordos:</strong> ${ruta.transbordos}</p>`;
                html += '<h4>üöá Recorrido:</h4>';
                
                ruta.ruta.forEach((estacionId, index) => {
                    const estacion = estaciones.find(e => e.id == estacionId);
                    let lineaActual = '';
                    
                    if (ruta.lineas) {
                        lineaActual = index < ruta.lineas.length ? ruta.lineas[index] : ruta.lineas[ruta.lineas.length - 1];
                    } else {
                        lineaActual = ruta.linea;
                    }
                    
                    html += '<div class="estacion">';
                    html += `<strong>${estacion.nombre}</strong>`;
                    
                    if (lineaActual && coloresLineas[lineaActual]) {
                        const color = coloresLineas[lineaActual];
                        html += ` <span class="linea-badge" style="background-color: ${color.bg}; color: ${color.text};">L√≠nea ${lineaActual}</span>`;
                    }
                    
                    if (index === 0) html += ' <span style="color: green;">üü¢ ORIGEN</span>';
                    if (index === ruta.ruta.length - 1) html += ' <span style="color: red;">üî¥ DESTINO</span>';
                    if (index > 0 && index < ruta.ruta.length - 1) html += ' <span style="color: orange;">üîÑ TRANSBORDO</span>';
                    
                    html += '</div>';
                });
                
                html += '</div>';
                resultadoDiv.innerHTML = html;
            }, 500);
        }

        // Cargar estaciones al iniciar
        window.onload = function() {
            cargarEstaciones();
        };
    </script>
</body>
</html> 